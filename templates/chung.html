<!--base.html-->
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Ph√≤ng kh√°m nh√≥m 3{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
  <div class="app-shell">
    
    <header class="topbar">
      <div class="brand">
        <div class="brand__logo">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo y t·∫ø">
        </div>
        <div class="brand__text">
          <div class="brand__name">Ph√≤ng kh√°m nh√≥m 3</div>
          <div class="brand__sub">H·ªá th·ªëng qu·∫£n l√Ω l·ªãch kh√°m</div>
        </div>
      </div>

      <div class="topbar__actions">
        {% block top_actions %}{% endblock %}
      </div>
    </header>

    <main class="container">
      {% block content %}{% endblock %}
    </main>
  </div>
</body>
</html>
<!--end_base.html-->

<!--dang_ky.html-->

{% extends "base.html" %}

{% block title %}
ƒêƒÉng k√Ω
{% endblock %}

{% block content %}
<div class="card auth auth--wide">

  <div class="card__header">
    <h1 class="h1">ƒêƒÉng k√Ω t√†i kho·∫£n</h1>
    <p class="muted">Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin ƒë·ªÉ t·∫°o t√†i kho·∫£n</p>
  </div>

  {% if loi %}
    <ul class="alert">
      {% for msg in loi %}
        <li>{{ msg }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <form method="post" class="form form--grid">

    <div class="field">
      <label class="label" for="ten_dang_nhap">T√™n ƒëƒÉng nh·∫≠p</label>
      <input
        class="input"
        type="text"
        id="ten_dang_nhap"
        name="ten_dang_nhap"
        required
      >
    </div>

    <div class="field">
      <label class="label" for="email">Email</label>
      <input
        class="input"
        type="email"
        id="email"
        name="email"
        required
      >
    </div>

    <div class="field">
      <label class="label" for="mat_khau">M·∫≠t kh·∫©u</label>
      <input
        class="input"
        type="password"
        id="mat_khau"
        name="mat_khau"
        required
      >
    </div>

    <div class="field">
      <label class="label" for="xac_nhan_mat_khau">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u</label>
      <input
        class="input"
        type="password"
        id="xac_nhan_mat_khau"
        name="xac_nhan_mat_khau"
        required
      >
    </div>

    <div class="field">
      <label class="label" for="ho_ten">H·ªç t√™n</label>
      <input
        class="input"
        type="text"
        id="ho_ten"
        name="ho_ten"
        required
      >
    </div>

    <div class="field">
      <label class="label" for="so_dien_thoai">S·ªë ƒëi·ªán tho·∫°i</label>
      <input
        class="input"
        type="text"
        id="so_dien_thoai"
        name="so_dien_thoai"
      >
    </div>

    <div class="field">
      <label class="label" for="ngay_sinh">Ng√†y sinh</label>
      <input
        class="input"
        type="date"
        id="ngay_sinh"
        name="ngay_sinh"
      >
    </div>

    <div class="field">
      <label class="label" for="gioi_tinh">Gi·ªõi t√≠nh</label>
      <select
        class="input"
        id="gioi_tinh"
        name="gioi_tinh"
      >
        <option value="">-- Ch·ªçn --</option>
        <option value="NAM">Nam</option>
        <option value="NU">N·ªØ</option>
        <option value="KHAC">Kh√°c</option>
      </select>
    </div>

    <div class="field field--full">
      <label class="label" for="dia_chi">ƒê·ªãa ch·ªâ</label>
      <textarea
        class="input"
        id="dia_chi"
        name="dia_chi"
        rows="3"
      ></textarea>
    </div>

    <div class="field field--full">
      <button type="submit" class="btn btn-primary">
        T·∫°o t√†i kho·∫£n
      </button>
    </div>

  </form>

  <div class="auth__footer">
    <span class="muted">ƒê√£ c√≥ t√†i kho·∫£n?</span>
    <a class="link" href="{{ url_for('dang_nhap') }}">ƒêƒÉng nh·∫≠p</a>
  </div>

</div>
{% endblock %}
<!--end_dang_ky.html-->

<!--dang_nhap.html-->

{% extends "base.html" %}

{% block title %}
ƒêƒÉng nh·∫≠p
{% endblock %}

{% block content %}
<div class="card auth">

  <div class="card__header">
    <h1 class="h1">ƒêƒÉng nh·∫≠p</h1>
    <p class="muted">Vui l√≤ng nh·∫≠p th√¥ng tin ƒë·ªÉ truy c·∫≠p h·ªá th·ªëng</p>
  </div>

  {% if loi %}
    <ul class="alert">
      {% for msg in loi %}
        <li>{{ msg }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <form method="post" class="form">

    <label class="label" for="ten_dang_nhap">T√™n ƒëƒÉng nh·∫≠p</label>
    <input
      class="input"
      type="text"
      id="ten_dang_nhap"
      name="ten_dang_nhap"
      required
    >

    <label class="label" for="mat_khau">M·∫≠t kh·∫©u</label>
    <input
      class="input"
      type="password"
      id="mat_khau"
      name="mat_khau"
      required
    >

    <button type="submit" class="btn btn-primary">
      ƒêƒÉng nh·∫≠p
    </button>

  </form>

  <div class="auth__footer">
    <span class="muted">Ch∆∞a c√≥ t√†i kho·∫£n?</span>
    <a class="link" href="{{ url_for('dang_ky') }}">ƒêƒÉng k√Ω</a>
  </div>

</div>
{% endblock %}
<!--end_dang_nhap.html-->

<!--danh_gia.html-->
{% extends "base.html" %}

{% block title %}ƒê√°nh gi√° b√°c sƒ©{% endblock %}

{% block content %}
<div class="card auth">
  <div class="card__header">
    <h1 class="h1">ƒê√°nh gi√° d·ªãch v·ª•</h1>
    <p class="muted">B√°c sƒ©: <strong>{{ lich.TenBacSi }}</strong></p>
    <p class="muted" style="font-size: 12px;">Ng√†y kh√°m: {{ lich.NgayKham }}</p>
  </div>

  <form method="post" class="form">
    <label class="label">M·ª©c ƒë·ªô h√†i l√≤ng</label>
    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
        <label><input type="radio" name="so_sao" value="5" checked> ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Tuy·ªát v·ªùi)</label><br>
    </div>
    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
        <label><input type="radio" name="so_sao" value="4"> ‚≠ê‚≠ê‚≠ê‚≠ê (T·ªët)</label>
    </div>
    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
        <label><input type="radio" name="so_sao" value="3"> ‚≠ê‚≠ê‚≠ê (B√¨nh th∆∞·ªùng)</label>
    </div>
    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
        <label><input type="radio" name="so_sao" value="2"> ‚≠ê‚≠ê (T·ªá)</label>
    </div>
    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
        <label><input type="radio" name="so_sao" value="1"> ‚≠ê (R·∫•t t·ªá)</label>
    </div>

    <label class="label" for="binh_luan">Nh·∫≠n x√©t c·ªßa b·∫°n</label>
    <textarea class="input" id="binh_luan" name="binh_luan" rows="4" placeholder="B√°c sƒ© kh√°m nh∆∞ th·∫ø n√†o?"></textarea>

    <button type="submit" class="btn btn-primary">G·ª≠i ƒë√°nh gi√°</button>
    <a href="{{ url_for('trang_benh_nhan') }}" class="btn btn-ghost">Quay l·∫°i</a>
  </form>
</div>
{% endblock %}
<!--end_danh_gia.html-->

<!--dat_lich.html-->

{% extends "base.html" %}

{% block title %}
ƒê·∫∑t l·ªãch kh√°m
{% endblock %}

{% block top_actions %}
<a class="btn btn-ghost" href="{{ url_for('trang_benh_nhan') }}">‚Üê Trang b·ªánh nh√¢n</a>
{% endblock %}

{% block content %}
<div class="card auth auth-large">

  <div class="card__header">
    <h1 class="h1">ƒê·∫∑t l·ªãch kh√°m</h1>
    <p class="muted">Ch·ªçn b√°c sƒ© v√† th·ªùi gian ph√π h·ª£p ƒë·ªÉ ƒë·∫∑t l·ªãch</p>
  </div>

  {% if loi %}
    <ul class="alert">
      {% for msg in loi %}
        <li>{{ msg }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <form method="post" class="form">

    <label class="label" for="bac_si">Ch·ªçn b√°c sƒ©</label>
    <select class="input" id="bac_si" name="bac_si" required>
      <option value="">-- Ch·ªçn b√°c sƒ© --</option>
      {% for bs in ds_bac_si %}
        <option value="{{ bs.BacSiID }}">{{ bs.HoTen }}</option>
      {% endfor %}
    </select>

    <div class="row">
      <div class="field">
        <label class="label" for="ngay_kham">Ng√†y kh√°m</label>
        <input class="input" type="date" id="ngay_kham" name="ngay_kham" required>
      </div>

      <div class="field">
        <label class="label" for="gio_kham">Gi·ªù kh√°m</label>
        <input class="input" type="time" id="gio_kham" name="gio_kham" required>
      </div>
    </div>

    <label class="label" for="ly_do">L√Ω do kh√°m (tu·ª≥ ch·ªçn)</label>
    <textarea class="input" id="ly_do" name="ly_do" rows="3"></textarea>

    <button type="submit" class="btn btn-primary">
      X√°c nh·∫≠n ƒë·∫∑t l·ªãch
    </button>

    <div class="hint">
      <a class="link" href="{{ url_for('thong_tin_phong_kham') }}">
        Xem th√¥ng tin ph√≤ng kh√°m & b√°c sƒ©
      </a>
    </div>

  </form>

</div>
{% endblock %}
<!--end_dat_lich.html-->

<!--ho_so_public.html-->
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>H·ªì s∆° s·ª©c kh·ªèe ƒëi·ªán t·ª≠</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="page-public">

  <div class="container container--narrow">
    
    <div class="card public-header">
        <div class="logo-circle">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo">
        </div>
        <h1 class="h1 text-blue">H·ªì S∆° Y T·∫ø Tr·ª±c Tuy·∫øn</h1>
        <p class="muted">Ph√≤ng kh√°m ƒêa khoa Thu·ª∑ L·ª£i</p>
    </div>

    <div class="card mb-20">
        <div class="card__header">
            <h2 class="h1 font-18">Th√¥ng tin h√†nh ch√≠nh</h2>
        </div>
        <div class="info">
            <div class="info__row">
                <span class="info__label">H·ªç t√™n:</span>
                <span class="text-lg text-bold">{{ bn.HoTen }}</span>
            </div>
            <div class="row">
                <div class="info__row">
                    <span class="info__label">Ng√†y sinh:</span>
                    <span>{{ bn.NgaySinh }}</span>
                </div>
                <div class="info__row">
                    <span class="info__label">Gi·ªõi t√≠nh:</span>
                    <span>
                        {% if bn.GioiTinh == 'NAM' %} Nam 
                        {% elif bn.GioiTinh == 'NU' %} N·ªØ 
                        {% else %} Kh√°c {% endif %}
                    </span>
                </div>
            </div>
            <div class="info__row">
                <span class="info__label">ƒê·ªãa ch·ªâ:</span>
                <span>{{ bn.DiaChi }}</span>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card__header">
            <h2 class="h1 font-18">L·ªãch s·ª≠ kh√°m b·ªánh</h2>
            <p class="muted">Danh s√°ch c√°c l·∫ßn kh√°m ƒë√£ ho√†n th√†nh</p>
        </div>

        {% if ls %}
            <div class="table-wrap">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Ng√†y</th>
                            <th>B√°c sƒ©</th>
                            <th>Th√¥ng tin kh√°m</th> 
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in ls %}
                        <tr>
                            <td class="col-top col-date">
                                <div class="text-bold">{{ item.NgayKham }}</div>
                                <div class="muted font-12">{{ item.TenChuyenKhoa }}</div>
                            </td>

                            <td class="col-top col-doc">
                                <strong>{{ item.TenBacSi }}</strong>
                                {% if item.DanhGiaCuaBenhNhan %}
                                    <div class="rating-badge">
                                        ‚òÖ ƒê√£ ƒë√°nh gi√°
                                    </div>
                                {% endif %}
                            </td>

                            <td class="col-top">
                                <div class="mb-8">
                                    <span class="tag tag--gray">L√ù DO</span>
                                    <span class="font-14">{{ item.LyDoKham }}</span>
                                </div>

                                {% if item.ChanDoan %}
                                <div class="mb-8">
                                    <span class="tag tag--blue">CH·∫®N ƒêO√ÅN</span>
                                    <span class="text-blue-dark font-medium">{{ item.ChanDoan }}</span>
                                </div>
                                {% endif %}

                                {% if item.ToaThuoc %}
                                <div>
                                    <span class="tag tag--green">TOA THU·ªêC</span>
                                    <div class="text-pre-line text-dark">{{ item.ToaThuoc }}</div>
                                </div>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="empty-state">
                <p>Ch∆∞a c√≥ l·ªãch s·ª≠ kh√°m b·ªánh n√†o ƒë∆∞·ª£c ghi nh·∫≠n.</p>
            </div>
        {% endif %}
    </div>
    
    <div class="public-footer">
        <p>H·ªì s∆° n√†y ƒë∆∞·ª£c chia s·∫ª t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng qu·∫£n l√Ω ph√≤ng kh√°m.</p>
        <p>N·∫øu b·∫°n kh√¥ng ph·∫£i l√† ng∆∞·ªùi ƒë∆∞·ª£c ·ªßy quy·ªÅn, vui l√≤ng ƒë√≥ng trang n√†y.</p>
    </div>

  </div>

</body>
</html>
<!--end_ho_so_public.html-->

<!--quan_ly_lich_hen.html-->

{% extends "base.html" %}

{% block title %}
Qu·∫£n l√Ω l·ªãch h·∫πn
{% endblock %}

{% block top_actions %}
  <div class="user-info">
      Xin ch√†o, <strong>{{ session.ho_ten }}</strong>
  </div>
  <a class="btn btn-danger" href="{{ url_for('dang_xuat') }}">ƒêƒÉng xu·∫•t</a>
{% endblock %}

{% block content %}
<div class="card">
  <div class="card__header card__header--row">
    <div>
        <h1 class="h1">Danh s√°ch l·ªãch h·∫πn</h1>
        <p class="muted">Qu·∫£n l√Ω v√† duy·ªát l·ªãch kh√°m b·ªánh</p>
    </div>
  </div>

  <div class="table-wrap">
    <table class="table">
      <thead>
        <tr>
          <th>M√£ s·ªë</th>
          <th>Th·ªùi gian</th>
          <th>B·ªánh nh√¢n</th>
          <th>Th√¥ng tin</th>
          {% if session.vai_tro == 'ADMIN' %}
            <th>B√°c sƒ© ph·ª• tr√°ch</th>
          {% endif %}
          <th>Tr·∫°ng th√°i</th>
          <th class="t-center">H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
        {% if ds_lich_hen %}
            {% for lh in ds_lich_hen %}
            <tr class="t-center">
              <td>{{ lh.LichHenID }}</td>
              <td>
                <div style="font-weight: bold;">{{ lh.GioKham }}</div>
                <div class="muted">{{ lh.NgayKham }}</div>
              </td>
              <td>
                <div style="font-weight: 700;">{{ lh.TenBenhNhan }}</div>
                <div style="font-size: 12px; color: #64748b;">
                    {{ lh.GioiTinh }} - {{ lh.NgaySinh }}
                </div>
              </td>
              <td style="max-width: 200px;">
                {% if lh.LyDoKham %}
                    {{ lh.LyDoKham }}
                {% else %}
                    <span class="muted">-- Kh√¥ng c√≥ l√Ω do --</span>
                {% endif %}
              </td>
              
              {% if session.vai_tro == 'ADMIN' %}
                <td>{{ lh.TenBacSi }}</td>
              {% endif %}

              <td>
                <span class="badge badge--{{ lh.TrangThai }}">
                  {% if lh.TrangThai == 'CHO_XAC_NHAN' %} Ch·ªù x√°c nh·∫≠n
                  {% elif lh.TrangThai == 'DA_XAC_NHAN' %} ƒê√£ duy·ªát
                  {% elif lh.TrangThai == 'DA_KHAM' %} ƒê√£ kh√°m
                  {% elif lh.TrangThai == 'HUY' %} ƒê√£ h·ªßy
                  {% elif lh.TrangThai == 'VANG_MAT' %} V·∫Øng m·∫∑t {% else %} {{ lh.TrangThai }}
                  {% endif %}
                </span>
              </td>
              <td class="t-center">
                <div style="display: flex; gap: 5px; justify-content: center;">
                    
                    {# N√∫t DUY·ªÜT: Ch·ªâ hi·ªán khi ƒëang CH·ªú X√ÅC NH·∫¨N #}
                    {% if lh.TrangThai == 'CHO_XAC_NHAN' %}
                    <form method="POST" action="{{ url_for('cap_nhat_trang_thai', lich_hen_id=lh.LichHenID, trang_thai='DA_XAC_NHAN') }}">
                        <button type="submit" class="btn btn-primary" style="padding: 6px 10px; font-size: 12px;">Duy·ªát</button>
                    </form>
                    {% endif %}

                    {# N√∫t HO√ÄN TH√ÄNH ho·∫∑c V·∫ÆNG M·∫∂T: Hi·ªán khi ƒê√É DUY·ªÜT #}
                    {% if lh.TrangThai == 'DA_XAC_NHAN' %}
                        <button type="button" 
                                class="btn btn-outline" 
                                style="padding: 6px 10px; font-size: 12px; color: var(--green); border-color: var(--green);"
                                onclick="moFormKham('{{ lh.LichHenID }}', '{{ lh.TenBenhNhan }}')">
                            Kh√°m
                        </button>

                        <form method="POST" action="{{ url_for('cap_nhat_trang_thai', lich_hen_id=lh.LichHenID, trang_thai='VANG_MAT') }}" onsubmit="return confirm('X√°c nh·∫≠n b·ªánh nh√¢n v·∫Øng m·∫∑t?');" style="display: inline;">
                            <button type="submit" class="btn btn-outline" style="padding: 6px 10px; font-size: 12px; color: #475569; border-color: #cbd5e1;">
                                V·∫Øng m·∫∑t
                            </button>
                        </form>
                    {% endif %}
                    
                    {# N√∫t H·ª¶Y: Hi·ªán khi ch∆∞a kh√°m xong ho·∫∑c ch∆∞a h·ªßy #}
                    {% if lh.TrangThai in ['CHO_XAC_NHAN', 'DA_XAC_NHAN'] %}
                    <form method="POST" action="{{ url_for('cap_nhat_trang_thai', lich_hen_id=lh.LichHenID, trang_thai='HUY') }}" onsubmit="return confirm('B·∫°n ch·∫Øc ch·∫Øn mu·ªën h·ªßy l·ªãch n√†y?');">
                        <button type="submit" class="btn btn-ghost" style="padding: 6px 10px; font-size: 12px; color: var(--red);">H·ªßy</button>
                    </form>
                    {% endif %}
                </div>
              </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="7" class="t-center muted" style="padding: 30px;">
                    Ch∆∞a c√≥ l·ªãch h·∫πn n√†o.
                </td>
            </tr>
        {% endif %}
      </tbody>
    </table>
      <div id="modalKham" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5);">
      <div class="card" style="margin: 10% auto; width: 500px; padding: 20px; position: relative;">
          
          <span onclick="document.getElementById('modalKham').style.display='none'" 
                style="position: absolute; right: 20px; top: 15px; font-size: 24px; cursor: pointer; color: #aaa;">&times;</span>
          
          <h2 class="h1" style="font-size: 20px; margin-bottom: 15px;">K·∫øt qu·∫£ kh√°m b·ªánh</h2>
          <p class="muted" style="margin-bottom: 20px;">Nh·∫≠p ch·∫©n ƒëo√°n v√† toa thu·ªëc cho b·ªánh nh√¢n: <strong id="modalTenBN"></strong></p>

          <form action="{{ url_for('luu_ket_qua_kham') }}" method="POST">
              <input type="hidden" name="lich_hen_id" id="modalLichHenID">

              <div class="field">
                  <label class="label">Ch·∫©n ƒëo√°n / K·∫øt lu·∫≠n</label>
                  <textarea class="input" name="chan_doan" rows="3" required placeholder="V√≠ d·ª•: Vi√™m h·ªçng c·∫•p..."></textarea>
              </div>

              <div class="field">
                  <label class="label">Toa thu·ªëc / Ch·ªâ ƒë·ªãnh</label>
                  <textarea class="input" name="toa_thuoc" rows="4" required placeholder="V√≠ d·ª•: Panadol 500mg (2 vi√™n/ng√†y)..."></textarea>
              </div>

              <div style="display: flex; gap: 10px; margin-top: 15px;">
                  <button type="submit" class="btn btn-primary" style="flex: 1;">L∆∞u & Ho√†n th√†nh</button>
                  <button type="button" class="btn btn-outline" onclick="document.getElementById('modalKham').style.display='none'" style="flex: 1;">ƒê√≥ng</button>
              </div>
          </form>
      </div>
  </div>

  <script>
      function moFormKham(id, tenBenhNhan) {
          document.getElementById('modalLichHenID').value = id;
          document.getElementById('modalTenBN').innerText = tenBenhNhan;
          document.getElementById('modalKham').style.display = 'block';
      }
      
      // ƒê√≥ng modal khi click ra ngo√†i
      window.onclick = function(event) {
          if (event.target == document.getElementById('modalKham')) {
              document.getElementById('modalKham').style.display = "none";
          }
      }
  </script>
  </div>
</div>
{% endblock %}
<!--end_quan_ly_lich_hen.html-->

<!--thong_tin_phong_kham.html-->

{% extends "base.html" %}

{% block title %}
Th√¥ng tin ph√≤ng kh√°m
{% endblock %}

{% block top_actions %}
  <a class="btn btn-ghost" href="{{ url_for('trang_benh_nhan') }}">‚Üê Trang b·ªánh nh√¢n</a>
{% endblock %}

{% block content %}
<div class="grid-2">

  <div class="card">
    <div class="card__header">
      <h1 class="h1">Th√¥ng tin ph√≤ng kh√°m</h1>
      <p class="muted">Th√¥ng tin li√™n h·ªá v√† gi·ªù l√†m vi·ªác</p>
    </div>

    <div class="info">
      <div class="info__row">
        <span class="info__label">T√™n:</span>
        <span>{{ thong_tin.ten }}</span>
      </div>
      <div class="info__row">
        <span class="info__label">ƒê·ªãa ch·ªâ:</span>
        <span>{{ thong_tin.dia_chi }}</span>
      </div>
      <div class="info__row">
        <span class="info__label">S·ªë ƒëi·ªán tho·∫°i:</span>
        <span>{{ thong_tin.so_dien_thoai }}</span>
      </div>
      <div class="info__row">
        <span class="info__label">Gi·ªù l√†m vi·ªác:</span>
        <span>{{ thong_tin.gio_lam_viec }}</span>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card__header">
      <h1 class="h1">Danh s√°ch b√°c sƒ©</h1>
      <p class="muted">B√°c sƒ© hi·ªán c√≥ trong h·ªá th·ªëng</p>
    </div>

    {% if ds_bac_si %}
      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>M√£</th>
              <th>H·ªç t√™n</th>
              <th>Chuy√™n khoa</th>
              <th>Kinh nghi·ªám</th>
              <th>ƒê√°nh gi√°</th> <th>SƒêT</th>
            </tr>
          </thead>

          <tbody>
            {% for bs in ds_bac_si %}
              <tr>
                <td>{{ bs.BacSiID }}</td>
                <td>{{ bs.HoTen }}</td>
                <td>{{ bs.TenChuyenKhoa }}</td>
                <td>{{ bs.KinhNghiemNam }} nƒÉm</td>
                
                <td>
                  {% if bs.LuotDanhGia > 0 %}
                      <span style="color: #f59e0b; font-weight: bold;">{{ bs.DiemTrungBinh }} ‚≠ê</span>
                      <div class="muted" style="font-size: 11px;">({{ bs.LuotDanhGia }} l∆∞·ª£t)</div>
                  {% else %}
                      <span class="muted" style="font-size: 12px;">Ch∆∞a c√≥</span>
                  {% endif %}
                </td>

                <td>{{ bs.SoDienThoai }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="muted">Ch∆∞a c√≥ b√°c sƒ© n√†o.</p>
    {% endif %}
  </div>

</div>
{% endblock %}

<!--end_thong_tin_phong_kham.html-->

<!--trang_benh_nhan.html-->

{% extends "base.html" %}

{% block title %}
L·ªãch h·∫πn c·ªßa t√¥i
{% endblock %}

{% block top_actions %}
  <a href="{{ url_for('dat_lich') }}" class="btn btn-primary">ƒê·∫∑t l·ªãch</a>
  <a href="{{ url_for('dang_xuat') }}" class="btn btn-outline">ƒêƒÉng xu·∫•t</a>
{% endblock %}

{% block content %}
{% if thong_bao_nhac_lich %}
<div class="alert" style="background-color: #fffbeb; border: 1px solid #fcd34d; color: #92400e; margin-bottom: 20px;">
    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
        <span style="font-size: 20px;">üîî</span>
        <strong>L·ªãch kh√°m s·∫Øp t·ªõi</strong>
    </div>
    <ul style="margin: 0; padding-left: 24px;">
        {% for msg in thong_bao_nhac_lich %}
            <li style="margin-bottom: 4px;">{{ msg }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}
<div class="card" style="margin-bottom: 20px;">
    <div class="card__header">
        <h3 class="h1" style="font-size: 16px;">Chia s·∫ª h·ªì s∆° y t·∫ø</h3>
        <p class="muted" style="font-size: 13px; margin-top: 4px;">T·∫°o m√£ QR ƒë·ªÉ b√°c sƒ© kh√°c c√≥ th·ªÉ xem l·ªãch s·ª≠ kh√°m c·ªßa b·∫°n.</p>
    </div>

    <div style="background: #f8fafc; padding: 15px; border-radius: 12px; border: 1px solid var(--border);">
        {% if share_token %}
            <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start;">
                
                <div style="background: white; padding: 10px; border-radius: 8px; border: 1px solid var(--border); flex-shrink: 0;">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data={{ request.url_root }}ho-so-y-te/{{ share_token }}" alt="QR Code" width="120" height="120">
                </div>

                <div style="flex: 1;">
                    <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 8px;">
                        <span style="color: var(--green); font-size: 18px;">‚óè</span>
                        <strong style="color: var(--green);">ƒêang chia s·∫ª c√¥ng khai</strong>
                    </div>
                    
                    <p style="font-size: 13px; color: var(--text-muted); margin: 0 0 10px 0; line-height: 1.4;">
                        Qu√©t m√£ b√™n c·∫°nh ho·∫∑c sao ch√©p ƒë∆∞·ªùng d·∫´n d∆∞·ªõi ƒë√¢y ƒë·ªÉ g·ª≠i cho b√°c sƒ©.
                    </p>
                    
                    <div style="margin-bottom: 12px;">
                        <input type="text" class="input" 
                               value="{{ request.url_root }}ho-so-y-te/{{ share_token }}" 
                               readonly 
                               onclick="this.select()"
                               style="font-size: 12px; background: #e2e8f0; color: #475569; padding: 8px;">
                    </div>

                    <form method="POST" action="{{ url_for('tao_lien_ket_chia_se') }}">
                        <input type="hidden" name="hanh_dong" value="huy">
                        <button type="submit" class="btn btn-outline" style="border-color: var(--red); color: var(--red); padding: 8px 16px; font-size: 13px; margin: 0;">
                            H·ªßy chia s·∫ª / V√¥ hi·ªáu h√≥a Link
                        </button>
                    </form>
                </div>
            </div>
        {% else %}
            <div style="display: flex; align-items: center; justify-content: space-between; gap: 15px;">
                <p class="muted" style="margin: 0; font-size: 13px;">H·ªì s∆° c·ªßa b·∫°n hi·ªán t·∫°i l√† <strong>Ri√™ng t∆∞</strong>.</p>
                
                <form method="POST" action="{{ url_for('tao_lien_ket_chia_se') }}">
                    <input type="hidden" name="hanh_dong" value="tao">
                    <button type="submit" class="btn btn-primary" style="margin: 0; font-size: 13px;">
                        + T·∫°o m√£ chia s·∫ª ngay
                    </button>
                </form>
            </div>
        {% endif %}
    </div>
</div>
<div class="card" style="margin-bottom: 20px; padding: 15px 20px;">
    <form method="POST" action="{{ url_for('xu_ly_cai_dat_thong_bao') }}" style="display: flex; align-items: center; justify-content: space-between;">
        
        <div>
            <h3 class="h1" style="font-size: 16px; margin-bottom: 4px;">Th√¥ng b√°o nh·∫Øc l·ªãch</h3>
            <p class="muted" style="margin: 0; font-size: 13px;">Nh·∫≠n nh·∫Øc nh·ªü tr√™n web tr∆∞·ªõc gi·ªù kh√°m 24 ti·∫øng.</p>
        </div>
        
        <div style="display: flex; align-items: center; gap: 12px;">
            <span style="font-size: 13px; font-weight: 600; color: var(--text-muted);">
                {{ 'ƒêANG B·∫¨T' if cai_dat_thong_bao == 1 else 'ƒêANG T·∫ÆT' }}
            </span>
            
            <label class="switch">
                <input type="checkbox" name="nhan_thong_bao" onchange="this.form.submit()" 
                       {% if cai_dat_thong_bao == 1 %}checked{% endif %}>
                <span class="slider round"></span>
            </label>
        </div>

    </form>
</div>
<div class="card">

  <div class="card__header card__header--row">
    <div>
      <h1 class="h1">L·ªãch h·∫πn c·ªßa t√¥i</h1>
      <p class="muted">Danh s√°ch c√°c l·ªãch kh√°m b·∫°n ƒë√£ ƒë·∫∑t</p>
    </div>

    <a href="{{ url_for('thong_tin_phong_kham') }}" class="btn btn-ghost">
      Th√¥ng tin ph√≤ng kh√°m
    </a>
  </div>

  {% if lich_hen %}
    <div class="table-wrap">
      <table class="table">
        <thead>
          <tr class="t-center">
            <th>B√°c sƒ©</th>
            <th>Ng√†y</th>
            <th>Gi·ªù</th>
            <th>Tr·∫°ng th√°i</th>
            <th>Thao t√°c</th>
          </tr>
        </thead>

        <tbody>
        {% for lh in lich_hen %}
          <tr class="t-center">
            <td>{{ lh.TenBacSi }}</td>
            <td>{{ lh.NgayKham }}</td>
            <td>{{ lh.GioKham }}</td>
            <td>
              <span class="badge badge--{{ lh.TrangThai }}">
                {% if lh.TrangThai == 'CHO_XAC_NHAN' %}
                  Ch·ªù x√°c nh·∫≠n
                {% elif lh.TrangThai == 'DA_XAC_NHAN' %}
                  ƒê√£ x√°c nh·∫≠n
                {% elif lh.TrangThai == 'DA_KHAM' %}
                  ƒê√£ kh√°m
                {% elif lh.TrangThai == 'HUY' %}
                  ƒê√£ hu·ª∑
                {% elif lh.TrangThai == 'VANG_MAT' %} 
                  V·∫Øng m·∫∑t
                {% endif %}
              </span>
            </td>
            <td class="t-center">
              {% if lh.TrangThai in ['CHO_XAC_NHAN', 'DA_XAC_NHAN'] %}
                <form
                  method="post"
                  action="{{ url_for('huy_lich', lich_hen_id=lh.LichHenID) }}"
                  onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën hu·ª∑ l·ªãch kh√°m n√†y?')"
                  class="inline-form"
                >
                  <button type="submit" class="btn btn-danger">
                    Hu·ª∑
                  </button>
                </form>
              {% elif lh.TrangThai == 'DA_KHAM' %}
                {% if lh.SoSao %}
                    <span style="color: #f59e0b; font-weight: bold;">
                        {{ lh.SoSao }} ‚≠ê
                    </span>
                {% else %}
                    <a href="{{ url_for('danh_gia', lich_hen_id=lh.LichHenID) }}" 
                       class="btn btn-outline" 
                       style="padding: 6px 12px; font-size: 12px; border-color: #f59e0b; color: #f59e0b;">
                       ƒê√°nh gi√°
                    </a>
                {% endif %}
              
              {% else %}
                <span class="muted">-</span>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="muted">B·∫°n ch∆∞a c√≥ l·ªãch h·∫πn n√†o.</p>
  {% endif %}

</div>
{% endblock %}

<!--end_trang_benh_nhan.html-->
