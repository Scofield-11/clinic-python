{% extends "base.html" %}

{% block title %}
Lịch hẹn của tôi
{% endblock %}

{% block top_actions %}
  <a href="{{ url_for('dat_lich') }}" class="btn btn-primary">Đặt lịch</a>
  <a href="{{ url_for('dang_xuat') }}" class="btn btn-outline">Đăng xuất</a>
{% endblock %}

{% block content %}
<div class="card">

  <div class="card__header card__header--row">
    <div>
      <h1 class="h1">Lịch hẹn của tôi</h1>
      <p class="muted">Danh sách các lịch khám bạn đã đặt</p>
    </div>

    <a href="{{ url_for('thong_tin_phong_kham') }}" class="btn btn-ghost">
      Thông tin phòng khám
    </a>
  </div>

  {% if lich_hen %}
    <div class="table-wrap">
      <table class="table">
        <thead>
          <tr>
            <th>Bác sĩ</th>
            <th>Ngày</th>
            <th>Giờ</th>
            <th>Trạng thái</th>
            <th class="t-center">Thao tác</th>
          </tr>
        </thead>

        <tbody>
        {% for lh in lich_hen %}
          <tr>
            <td>{{ lh.TenBacSi }}</td>
            <td>{{ lh.NgayKham }}</td>
            <td>{{ lh.GioKham }}</td>
            <td>
              <span class="badge badge--{{ lh.TrangThai }}">
                {{ lh.TrangThai }}
              </span>
            </td>
            <td class="t-center">
              {% if lh.TrangThai in ['CHO_XAC_NHAN', 'DA_XAC_NHAN'] %}
                <form
                  method="post"
                  action="{{ url_for('huy_lich', lich_hen_id=lh.LichHenID) }}"
                  onsubmit="return confirm('Bạn có chắc chắn muốn huỷ lịch khám này?')"
                  class="inline-form"
                >
                  <button type="submit" class="btn btn-danger">
                    Huỷ
                  </button>
                </form>
              {% else %}
                <span class="muted">-</span>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="muted">Bạn chưa có lịch hẹn nào.</p>
  {% endif %}

</div>
{% endblock %}
